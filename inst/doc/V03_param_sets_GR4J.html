<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Olivier Delaigue, Guillaume Thirel" />


<title>Generalist parameter sets for the GR4J model</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Generalist parameter sets for the GR4J
model</h1>
<h4 class="author">Olivier Delaigue, Guillaume Thirel</h4>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<div id="scope" class="section level2">
<h2>Scope</h2>
<p>In the <strong>airGR</strong> package, the classical way to calibrate
a model is to use the Michel’s algorithm (see the
<code>Calibration_Michel()</code> function).</p>
<p>The Michel’s algorithm combines a global and a local approach. A
screening is first performed either based on a rough predefined grid
(considering various initial values for each parameter) or from a list
of initial parameter sets. The best set identified in this screening is
then used as a starting point for the steepest descent local search
algorithm.</p>
<p>In some specific situations, for example if the calibration period is
too short and by consequence non representative of the catchment
behaviour, a local calibration algorithm can give poor results.</p>
<p>In this vignette, we show a method using a known parameter set that
can be used as an alternative for the grid-screening calibration
procedure, and we well compare to two methods using the
<code>Calibration_Michel()</code> function. The generalist parameters
sets introduced here are taken from <span class="citation">Andréassian
et al. (2014)</span>.</p>
</div>
<div id="data-preparation" class="section level2">
<h2>Data preparation</h2>
<p>We load an example data set from the package and the GR4J parameter
sets.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="do">## loading catchment data</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">data</span>(L0123001)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="do">## loading generalist parameter sets</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">data</span>(Param_Sets_GR4J)</span></code></pre></div>
<p>The given GR4J <strong>X4u</strong> variable does not correspond to
the actual GR4J <strong>X4</strong> parameter. As explained in <span class="citation">Andréassian et al. (2014, sec. 2.1)</span>, the given
GR4J <strong>X4u</strong> value has to be adjusted (rescaled) using
catchment area (S) [km2] as follows:
<code>X4 = X4u / 5.995 * S^0.3</code> (please= note that <strong>the
formula is erroneous in the publication</strong>).</p>
<p>It means we need first to transform the <strong>X4</strong>
parameter.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>Param_Sets_GR4J<span class="sc">$</span>X4 <span class="ot">&lt;-</span> Param_Sets_GR4J<span class="sc">$</span>X4u <span class="sc">/</span> <span class="fl">5.995</span> <span class="sc">*</span> BasinInfo<span class="sc">$</span>BasinArea<span class="sc">^</span><span class="fl">0.3</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>Param_Sets_GR4J<span class="sc">$</span>X4u <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>Param_Sets_GR4J <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(Param_Sets_GR4J)</span></code></pre></div>
<p>Please, find below the summary of the 27 sets of the 4
parameters.</p>
<pre><code>##        X1             X2              X3            X4      
##  Min.   : 126   Min.   :-54.5   Min.   :  8   Min.   :1.21  
##  1st Qu.: 208   1st Qu.: -2.0   1st Qu.: 35   1st Qu.:1.75  
##  Median : 291   Median : -1.1   Median : 76   Median :2.10  
##  Mean   : 471   Mean   : -3.4   Mean   : 90   Mean   :2.09  
##  3rd Qu.: 359   3rd Qu.: -0.6   3rd Qu.:106   3rd Qu.:2.45  
##  Max.   :4006   Max.   :  0.8   Max.   :318   Max.   :3.47</code></pre>
</div>
<div id="object-model-preparation" class="section level2">
<h2>Object model preparation</h2>
<p>We assume that the R global environment contains data and functions
from the <a href="V01_get_started.html">Get Started</a> vignette.</p>
<p>The calibration period has been defined from
<strong>1990-01-01</strong> to <strong>1990-02-28</strong>, and the
validation period from <strong>1990-03-01</strong> to
<strong>1999-12-31</strong>.</p>
<p>As a consequence, in this example the calibration period is very
short, less than 6 months.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="do">## preparation of the InputsModel object</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>InputsModel <span class="ot">&lt;-</span> <span class="fu">CreateInputsModel</span>(<span class="at">FUN_MOD =</span> RunModel_GR4J, <span class="at">DatesR =</span> BasinObs<span class="sc">$</span>DatesR, </span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>                                 <span class="at">Precip =</span> BasinObs<span class="sc">$</span>P, <span class="at">PotEvap =</span> BasinObs<span class="sc">$</span>E)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="do">## ---- calibration step</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="do">## short calibration period selection (&lt; 6 months)</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>Ind_Cal <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">which</span>(<span class="fu">format</span>(BasinObs<span class="sc">$</span>DatesR, <span class="at">format =</span> <span class="st">&quot;%d/%m/%Y %H:%M&quot;</span>)<span class="sc">==</span><span class="st">&quot;01/01/1990 00:00&quot;</span>), </span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>               <span class="fu">which</span>(<span class="fu">format</span>(BasinObs<span class="sc">$</span>DatesR, <span class="at">format =</span> <span class="st">&quot;%d/%m/%Y %H:%M&quot;</span>)<span class="sc">==</span><span class="st">&quot;28/02/1990 00:00&quot;</span>))</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="do">## preparation of the RunOptions object for the calibration period</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>RunOptions_Cal <span class="ot">&lt;-</span> <span class="fu">CreateRunOptions</span>(<span class="at">FUN_MOD =</span> RunModel_GR4J,</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>                                   <span class="at">InputsModel =</span> InputsModel, <span class="at">IndPeriod_Run =</span> Ind_Cal)</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="do">## efficiency criterion: Nash-Sutcliffe Efficiency</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>InputsCrit_Cal  <span class="ot">&lt;-</span> <span class="fu">CreateInputsCrit</span>(<span class="at">FUN_CRIT =</span> ErrorCrit_NSE, <span class="at">InputsModel =</span> InputsModel, </span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>                                    <span class="at">RunOptions =</span> RunOptions_Cal, <span class="at">Obs =</span> BasinObs<span class="sc">$</span>Qmm[Ind_Cal])</span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="do">## ---- validation step</span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a><span class="do">## validation period selection</span></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a>Ind_Val <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">which</span>(<span class="fu">format</span>(BasinObs<span class="sc">$</span>DatesR, <span class="at">format =</span> <span class="st">&quot;%d/%m/%Y %H:%M&quot;</span>)<span class="sc">==</span><span class="st">&quot;01/03/1990 00:00&quot;</span>), </span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a>               <span class="fu">which</span>(<span class="fu">format</span>(BasinObs<span class="sc">$</span>DatesR, <span class="at">format =</span> <span class="st">&quot;%d/%m/%Y %H:%M&quot;</span>)<span class="sc">==</span><span class="st">&quot;31/12/1999 00:00&quot;</span>))</span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a><span class="do">## preparation of the RunOptions object for the validation period</span></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a>RunOptions_Val <span class="ot">&lt;-</span> <span class="fu">CreateRunOptions</span>(<span class="at">FUN_MOD =</span> RunModel_GR4J,</span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a>                                   <span class="at">InputsModel =</span> InputsModel, <span class="at">IndPeriod_Run =</span> Ind_Val)</span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a></span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a><span class="do">## efficiency criterion (Nash-Sutcliffe Efficiency) on the validation period</span></span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a>InputsCrit_Val  <span class="ot">&lt;-</span> <span class="fu">CreateInputsCrit</span>(<span class="at">FUN_CRIT =</span> ErrorCrit_NSE, <span class="at">InputsModel =</span> InputsModel, </span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a>                                    <span class="at">RunOptions =</span> RunOptions_Val, <span class="at">Obs =</span> BasinObs<span class="sc">$</span>Qmm[Ind_Val])</span></code></pre></div>
</div>
</div>
<div id="calibration-of-the-gr4j-model-with-the-generalist-parameter-sets" class="section level1">
<h1>Calibration of the GR4J model with the generalist parameter
sets</h1>
<p>It is recommended to use the generalist parameter sets when the
calibration period is less than 6 months.</p>
<p>As shown in <span class="citation">Andréassian et al. (2014, fig.
4)</span>, a recommended way to use the <code>Param_Sets_GR4J</code>
<code>data.frame</code> is to run the GR4J model with each parameter set
and to select the best one according to an objective function (here we
use the Nash-Sutcliffe Efficiency criterion).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>OutputsCrit_Loop <span class="ot">&lt;-</span> <span class="fu">apply</span>(Param_Sets_GR4J, <span class="dv">1</span>, <span class="cf">function</span>(iParam) {</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  OutputsModel_Cal <span class="ot">&lt;-</span> <span class="fu">RunModel_GR4J</span>(<span class="at">InputsModel =</span> InputsModel, <span class="at">RunOptions =</span> RunOptions_Cal,</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>                                    <span class="at">Param =</span> iParam)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  OutputsCrit <span class="ot">&lt;-</span> <span class="fu">ErrorCrit_NSE</span>(<span class="at">InputsCrit =</span> InputsCrit_Cal, <span class="at">OutputsModel =</span> OutputsModel_Cal)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="fu">return</span>(OutputsCrit<span class="sc">$</span>CritValue)</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>})</span></code></pre></div>
<p>Find below the 27 criteria corresponding to the different parameter
sets.</p>
<p>The criterion values are quite low (from -1.639 to 0.336), which can
be expected as this does not represents an actual calibration.</p>
<pre><code>##  [1]  0.0573  0.1331 -0.0168  0.1613  0.0345  0.1046 -0.0458  0.3359  0.2440
## [10] -0.3858 -0.0830 -1.0930  0.2843  0.2792  0.1505 -0.0209 -0.0825  0.1298
## [19]  0.2903 -0.1188 -0.3834 -0.0836  0.0279 -0.0488 -0.1675  0.1719 -1.6386</code></pre>
<p>The parameter set corresponding to the best criterion is the
following:</p>
<pre><code>##     X1     X2     X3     X4 
## 291.00   0.30 109.10   2.01</code></pre>
<p>Now we can compute the Nash-Sutcliffe Efficiency criterion on the
validation period. A quite good value (0.777) is found.</p>
</div>
<div id="calibration-of-the-gr4j-model-with-the-built-in-calibration_michel-function" class="section level1">
<h1>Calibration of the GR4J model with the built-in Calibration_Michel
function</h1>
<p>As seen above, the Michel’s calibration algorithm is based on a local
search procedure.</p>
<p>It is <strong>not recommanded</strong> to use the
<code>Calibration_Michel()</code> function when the <strong>calibration
period is less than 6 month</strong>. We will show below its application
on the same short period for two configurations of the grid-screening
step to demonstrate that it is less efficient than the generalist
parameters sets calibration.</p>
<div id="gr4j-parameter-distributions-quantiles-used-in-the-grid-screening-step" class="section level2">
<h2>GR4J parameter distributions quantiles used in the grid-screening
step</h2>
<p>By default, the predefined grid used by the
<code>Calibration_Michel()</code> function contains parameters quantiles
computed after recursive calibrations on 1200 basins (from Australia,
France and USA).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>CalibOptions <span class="ot">&lt;-</span> <span class="fu">CreateCalibOptions</span>(<span class="at">FUN_MOD =</span> RunModel_GR4J, <span class="at">FUN_CALIB =</span> Calibration_Michel)</span></code></pre></div>
<p>The parameter set corresponding to the best criterion is the
following:</p>
<pre><code>##     X1     X2     X3     X4 
## 165.05   6.46 422.50   2.45</code></pre>
<p>The Nash-Sutcliffe Efficiency criterion computed on the calibration
period is better (0.495) than with the generalist parameter sets, but
the one computed on the validation period is lower (0.57). This shows
that the generalist parameter sets give more robust model in this
case.</p>
</div>
<div id="gr4j-parameter-sets-used-in-the-grid-screening-step" class="section level2">
<h2>GR4J parameter sets used in the grid-screening step</h2>
<p>It is also possible to give to the <code>CreateCalibOptions()</code>
function a matrix of parameter sets used for the grid-screening
calibration procedure. So, it possible is to use by this way the GR4J
generalist parameter sets.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>CalibOptions <span class="ot">&lt;-</span> <span class="fu">CreateCalibOptions</span>(<span class="at">FUN_MOD =</span> RunModel_GR4J, <span class="at">FUN_CALIB =</span> Calibration_Michel,</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>                                   <span class="at">StartParamList =</span> Param_Sets_GR4J)</span></code></pre></div>
<p>Here is the parameter set corresponding to the best criteria
found.</p>
<pre><code>##     X1     X2     X3     X4 
## 161.62   6.53 429.00   2.45</code></pre>
<p>The results are the same here. The Nash-Sutcliffe Efficiency
criterion computed on the calibration period is better (0.495), but the
one computed on the validation period is just a little bit lower (0.568)
than the classical calibration.</p>
<p>Generally, the advantage of using GR4J parameter sets rather than the
GR4J generalist parameter quantiles is that they make more sense than a
simple exploration of combinations of quantiles of parameter
distributions (each parameter set represents a consistent ensemble). In
addition, for the first step, the number of iterations is smaller (27
runs instead of 81), which can save time if one wants to run a very
large number of calibrations.</p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-andreassian_seeking_2014" class="csl-entry">
Andréassian, Vazken, François Bourgin, Ludovic Oudin, Thibault Mathevet,
Charles Perrin, Julien Lerat, Laurent Coron, and Lionel Berthet. 2014.
<span>“Seeking Genericity in the Selection of Parameter Sets:
<span>Impact</span> on Hydrological Model Efficiency.”</span> <em>Water
Resources Research</em> 50 (10): 8356–66. <a href="https://doi.org/10.1002/2013WR014761">https://doi.org/10.1002/2013WR014761</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
